<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lightcurves</title>
  <link rel="stylesheet" href="/static/lightcurves.css">
  <link rel="icon" href="/static/images/favicon.png" type="image/x-icon">
</head>

<body class="lightcurves-page">
  <!-- Left Sidebar Navigation -->
  <nav id="lightcurves-navigation">
    <a href="https://hatpi.org" class="nav-home-link">üè°</a>

    <!-- Search Form inside the Sidebar -->
    <div id="search-form-sidebar">

      <h2 class="nav-section-title">
        <img src="/static/icons/search.svg" alt="Gear Icon" class="nav-icon">
        Search
      </h2>
      <form method="POST">
        <label for="ra">
          <img src="/static/icons/RA.png" alt="Gear Icon" class="small-icon">
          RA (deg)</label>
        <input type="text" id="ra" name="ra" placeholder="e.g. 180.07" value="{{ ra|default('') }}" />

        <label for="dec">
          <img src="/static/icons/DEC.png" alt="Gear Icon" class="small-icon">
          DEC (deg)</label>
        <input type="text" id="dec" name="dec" placeholder="e.g. -83.553" value="{{ dec|default('') }}" />

        <label for="date_type">Date Type</label>
        <select id="date_type" name="date_type">
          <option value="datetime" {% if date_type=='datetime' %}selected{% endif %}>datetime</option>
          <option value="JD" {% if date_type=='JD' %}selected{% endif %}>JD</option>
        </select>
        <small>If "datetime", format is YYYY-MM-DD.<br />If "JD", enter float such as 2459990.5.</small>

        <label for="date_min">Date Min</label>
        <input type="text" id="date_min" name="date_min" placeholder="YYYY-MM-DD or 2459990.5"
          value="{{ date_min_input|default('') }}" />

        <label for="date_max">Date Max</label>
        <input type="text" id="date_max" name="date_max" placeholder="YYYY-MM-DD or 2459991.5"
          value="{{ date_max_input|default('') }}" />

        <button type="submit" class="visit-button">Submit</button>
      </form>

    </div>

  </nav>

  <!-- Main content area for query results -->
  <main>
    <section id="results">
      {% if error %}
      <p class="error-text">{{ error }}</p>
      {% endif %}

      {% if message %}
      <p class="message-text">{{ message }}</p>
      {% endif %}

      {% if frames is none %}
      <div class="section-card">
        <div class="title-container">
          <div class="title-row">
            <h2 class="section-title">Awaiting search ‚ú®</h2>
          </div>
        </div>
        <div class="content-area">
          <!-- Optionally add a placeholder message -->
        </div>
      </div>

      {% elif frames %}
      <div class="section-card">
        <!-- New Title Container Layout for Results -->
        <div class="title-container">
          <!-- First row: Frames Found -->
          <div class="title-row">
            <div class="search-info-box">
              Frames Found: {{ frames|length }}
            </div>
          </div>
          <!-- Second row: Query details -->
          <div class="title-row search-info-row">
            <div class="search-info-box">RA: {{ ra|default('N/A') }}</div>
            <div class="search-info-box">DEC: {{ dec|default('N/A') }}</div>
            <div class="search-info-box">Date Min: {{ date_min_input|default('N/A') }}</div>
            <div class="search-info-box">Date Max: {{ date_max_input|default('N/A') }}</div>
          </div>
        </div>
        <div class="content-area">
          <div class="table-wrapper">
            <table class="frames-table">
              <thead>
                <tr>
                  <th>Object</th>
                  <th>IHUID</th>
                  <th>FNUM</th>
                  <th>Path</th>
                  <th>Datetime Obs</th>
                  <th>EXPTIME</th>
                </tr>
              </thead>
              <tbody>
                {% for f in frames %}
                <tr>
                  <td>{{ f.OBJECT }}</td>
                  <td>{{ f.IHUID }}</td>
                  <td>{{ f.FNUM }}</td>
                  <td>{{ f.relpath }}</td>
                  <td>{{ f.datetime_obs }}</td>
                  <td>{{ f.EXPTIME }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>

      {% else %}
      <div class="section-card">
        <div class="title-container">
          <div class="title-row">
            <h2 class="section-title">Results</h2>
          </div>
        </div>
        <div class="content-area">
          <p>No frames found for that coordinate &amp; date range.</p>
        </div>
      </div>
      {% endif %}
    </section>

  </main>

  <script src="/static/lightcurves.js"></script>
</body>

</html>